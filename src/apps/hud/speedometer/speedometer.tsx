import React from "react";
import "./speedometer.scss";

interface SpeedometerState {
	speed: number;
	gear: number;
}

const Speedometer: React.FC = () => {
	const [state, setState] = React.useState<SpeedometerState | undefined>(undefined);

	const onMessage = (event: any) => {
		if (event.data.type == "speedometer") {
			setState(event.data.data);
		}
	};

	React.useEffect(() => {
		window.addEventListener("message", onMessage);
		return () => window.removeEventListener("message", onMessage);
	});

	const getSpeed = () => {
		if (state?.speed < 10) {
			return "00" + state?.speed;
		} else if (state?.speed < 100) {
			return "0" + state?.speed;
		} else {
			return state?.speed;
		}
	};

	return (
		<div id="speedometer-container" style={{ opacity: !!state ? 1 : 0 }}>
			<div style={{ display: "flex", flexDirection: "row", alignItems: "center", justifyContent: "space-between" }}>
				<div className="gear">{state?.gear}</div>

				<p style={{ marginRight: 2, opacity: 1, letterSpacing: 2 }}>{getSpeed()}</p>
			</div>

			<div style={{ display: "flex", flexDirection: "row", alignItems: "center", justifyContent: "space-between" }}>
				<svg width="85" height="40" viewBox="0 0 41 10" xmlns="http://www.w3.org/2000/svg">
					<g clip-path="url(#clip0_32_133)">
						<path
							d="M34.3247 2.51573L32.7195 1.00777C32.6413 0.934258 32.5141 0.934258 32.4358 1.00777C32.3576 1.08129 32.3576 1.2008 32.4358 1.27431L33.8993 2.64882L32.5779 3.89026L31.1144 2.51573C31.0361 2.44222 30.9089 2.44222 30.8307 2.51573C30.7524 2.58925 30.7524 2.70876 30.8307 2.78227L32.4358 4.29023C32.4751 4.3268 32.5265 4.34528 32.5779 4.34528C32.6292 4.34528 32.6806 4.32681 32.7195 4.29023L34.3247 2.78227C34.4029 2.70876 34.4029 2.58925 34.3247 2.51573Z"
							fill="white"
						/>
						<path
							d="M35.6468 3.0027L35.0103 2.40479C34.7756 2.18424 34.394 2.18424 34.1592 2.40479L32.3301 4.12311C32.2162 4.23055 32.1536 4.37268 32.1536 4.52385C32.1536 4.67464 32.2162 4.8164 32.3293 4.92232C32.5195 5.10064 32.7663 5.33852 32.9541 5.52061C33.0673 5.63031 33.2186 5.69138 33.3807 5.69251C33.3827 5.69251 33.3843 5.69251 33.3859 5.69251C33.5468 5.69251 33.6977 5.6337 33.8117 5.52626L35.6468 3.80228C35.8815 3.58176 35.8815 3.22324 35.6468 3.0027ZM35.3635 3.53613L33.5284 5.26011C33.4899 5.2963 33.4325 5.31403 33.3847 5.31553C33.331 5.31516 33.2808 5.29517 33.2431 5.25861C33.0537 5.07502 32.8053 4.83562 32.6135 4.6558C32.5757 4.62037 32.5549 4.57361 32.5549 4.52385C32.5549 4.47332 32.5757 4.42582 32.6139 4.39002L34.4429 2.6717C34.4823 2.63474 34.5336 2.61665 34.585 2.61665C34.6364 2.61665 34.6877 2.63474 34.727 2.6717L35.3635 3.26922C35.4012 3.30504 35.4221 3.35215 35.4221 3.40268C35.4221 3.4532 35.4012 3.50033 35.3635 3.53613Z"
							fill="white"
						/>
						<path
							d="M36.5334 4.96614L35.3295 3.83516C35.2513 3.76165 35.124 3.76165 35.0458 3.83516C34.9675 3.90868 34.9675 4.02819 35.0458 4.1017L36.1076 5.09922L35.1875 5.96365L34.1252 4.96614C34.047 4.89262 33.9198 4.89262 33.8415 4.96614C33.7633 5.03965 33.7633 5.15916 33.8415 5.23268L35.0454 6.36365C35.0847 6.40021 35.1361 6.41869 35.1875 6.41869C35.2388 6.41869 35.2902 6.40023 35.3295 6.36365L36.5334 5.23268C36.6116 5.15914 36.6116 5.03965 36.5334 4.96614Z"
							fill="white"
						/>
						<path
							d="M34.7263 3.26961C34.6481 3.1961 34.5209 3.1961 34.4426 3.26961L33.2387 4.40059C33.1605 4.4741 33.1605 4.59362 33.2387 4.66713C33.2781 4.70369 33.3294 4.72218 33.3808 4.72218C33.4322 4.72218 33.4835 4.70371 33.5225 4.66713L34.7263 3.53615C34.8046 3.46262 34.8046 3.34313 34.7263 3.26961Z"
							fill="white"
						/>
						<path
							d="M40.3448 8.17049L39.1409 7.03951C39.0627 6.966 38.9354 6.966 38.8572 7.03951L37.252 8.54747C37.1738 8.62099 37.1738 8.7405 37.252 8.81401L38.4559 9.94499C38.4952 9.98155 38.5466 10 38.598 10C38.6493 10 38.7007 9.98157 38.7396 9.94462C38.8179 9.8711 38.8179 9.75159 38.7396 9.67808L37.6778 8.68056L38.9993 7.43912L40.0611 8.43701C40.1393 8.51052 40.2665 8.51052 40.3448 8.43701C40.423 8.36351 40.423 8.244 40.3448 8.17049Z"
							fill="white"
						/>
						<path
							d="M39.1852 7.10255C39.1735 7.07465 39.1555 7.05053 39.1326 7.03167C39.064 6.94835 38.7422 6.48201 38.0295 5.40156C37.9328 5.2549 37.7727 5.15916 37.5905 5.13917C37.4063 5.11919 37.2257 5.17876 37.0941 5.3024L35.3986 6.89519C35.269 7.01734 35.206 7.18509 35.2261 7.35663C35.2461 7.52817 35.3465 7.67972 35.5014 7.77246L37.2863 8.83973C37.3196 8.85972 37.3569 8.86914 37.3943 8.86914C37.446 8.86914 37.4974 8.85028 37.5355 8.81335L39.1407 7.30538C39.1972 7.25221 39.2149 7.17267 39.1852 7.10255ZM37.3665 8.4405L35.7172 7.45466C35.6655 7.42375 35.6322 7.37323 35.6253 7.31592C35.6185 7.25861 35.6398 7.20245 35.6827 7.1621L37.3782 5.56932C37.4171 5.53312 37.4681 5.51314 37.5214 5.51314C37.5291 5.51314 37.5367 5.51351 37.5455 5.51427C37.5804 5.51803 37.6458 5.53426 37.6896 5.60059C38.2839 6.50198 38.574 6.9408 38.7349 7.15493L37.3665 8.4405Z"
							fill="white"
						/>
						<path
							d="M37.937 6.2856C37.8588 6.21209 37.7316 6.21209 37.6533 6.2856L36.4494 7.41658C36.3712 7.4901 36.3712 7.60961 36.4494 7.68312C36.4888 7.71968 36.5401 7.73817 36.5915 7.73817C36.6429 7.73817 36.6942 7.7197 36.7332 7.68312L37.937 6.55214C38.0153 6.47863 38.0153 6.35912 37.937 6.2856Z"
							fill="white"
						/>
						<path
							d="M36.5914 2.83728C36.4806 2.83728 36.3907 2.92173 36.3907 3.02578V3.40277C36.3907 3.50682 36.4806 3.59127 36.5914 3.59127C36.7022 3.59127 36.792 3.50682 36.792 3.40277V3.02578C36.792 2.92173 36.7022 2.83728 36.5914 2.83728Z"
							fill="white"
						/>
						<path
							d="M38.1971 4.34521H37.7959C37.6851 4.34521 37.5952 4.42967 37.5952 4.53372C37.5952 4.63777 37.6851 4.72222 37.7959 4.72222H38.1971C38.3079 4.72222 38.3978 4.63777 38.3978 4.53372C38.3978 4.42967 38.3079 4.34521 38.1971 4.34521Z"
							fill="white"
						/>
						<path
							d="M37.9371 3.26961C37.8588 3.1961 37.7316 3.1961 37.6533 3.26961L37.252 3.6466C37.1738 3.72011 37.1738 3.83963 37.252 3.91314C37.2914 3.9497 37.3427 3.96819 37.3941 3.96819C37.4455 3.96819 37.4968 3.94972 37.5358 3.91314L37.9371 3.53615C38.0153 3.46262 38.0153 3.34313 37.9371 3.26961Z"
							fill="white"
						/>
						<path
							d="M34.5854 7.36108C34.4747 7.36108 34.3848 7.44554 34.3848 7.54959V7.92657C34.3848 8.03062 34.4747 8.11507 34.5854 8.11507C34.6962 8.11507 34.7861 8.03062 34.7861 7.92657V7.54959C34.7861 7.44554 34.6962 7.36108 34.5854 7.36108Z"
							fill="white"
						/>
						<path
							d="M33.3814 6.2301H32.9801C32.8693 6.2301 32.7794 6.31455 32.7794 6.4186C32.7794 6.52265 32.8693 6.60711 32.9801 6.60711H33.3814C33.4921 6.60711 33.582 6.52265 33.582 6.4186C33.582 6.31455 33.4921 6.2301 33.3814 6.2301Z"
							fill="white"
						/>
						<path
							d="M33.9237 7.03951C33.8455 6.966 33.7183 6.966 33.64 7.03951L33.2387 7.4165C33.1605 7.49001 33.1605 7.60952 33.2387 7.68304C33.2781 7.7196 33.3294 7.73809 33.3808 7.73809C33.4322 7.73809 33.4835 7.71962 33.5225 7.68304L33.9237 7.30605C34.002 7.23254 34.002 7.11302 33.9237 7.03951Z"
							fill="white"
						/>
					</g>
					<g clip-path="url(#clip1_32_133)">
						<path
							d="M7.03663 5.88272H10.4977V6.58957H6.91819C6.96169 6.37241 7.00254 6.13543 7.03663 5.88272ZM7.13068 4.52205C7.13068 4.6414 7.12833 4.75923 7.12407 4.87547H10.4977V4.16862H7.12407C7.12833 4.2848 7.13068 4.4027 7.13068 4.52205ZM6.90746 2.40151C6.95184 2.61785 6.99394 2.85489 7.02936 3.10836H10.4977V2.40151H6.90746ZM5.83529 7.73225C5.85748 7.67337 6.37828 6.26962 6.37828 4.52205C6.37828 2.77447 5.85748 1.37065 5.83529 1.31177L5.74065 1.0603L5.45732 1.07687C5.41148 1.07956 4.32167 1.14742 3.21636 1.58305C1.67937 2.1887 0.866943 3.205 0.866943 4.52205C0.866943 5.83903 1.67937 6.85532 3.21636 7.46104C4.32167 7.89661 5.4114 7.96453 5.45725 7.96722L5.74065 7.98379L5.83529 7.73225ZM5.62588 4.52205C5.62588 5.71851 5.35622 6.762 5.21301 7.23187C4.83946 7.18452 4.15995 7.06876 3.49153 6.803C2.24926 6.3089 1.61934 5.54152 1.61934 4.52205C1.61934 3.50258 2.24926 2.73512 3.49153 2.24109C4.16017 1.9752 4.83997 1.85944 5.21331 1.81215C5.35666 2.28099 5.62588 3.32165 5.62588 4.52205V4.52205Z"
							fill="white"
						/>
					</g>
					<path
						d="M22.7459 5.37408L22.7607 4.21189L23.9583 5.33509C24.0184 5.39144 24.0977 5.42015 24.1774 5.42105C24.257 5.42194 24.337 5.39502 24.3985 5.34003C24.5215 5.23009 24.5238 5.04962 24.4037 4.93699L22.771 3.40573L22.7731 3.23401L22.7905 1.87057C22.7964 1.40224 22.3545 1.01623 21.8053 1.01006L19.4187 0.983266C18.8695 0.977101 18.4178 1.35308 18.4119 1.82141L18.3945 3.18485L18.3923 3.35658L16.7212 4.85074C16.5982 4.96068 16.5959 5.14114 16.716 5.25378C16.7761 5.31009 16.8554 5.33884 16.9351 5.33974C17.0147 5.34063 17.0948 5.31371 17.1563 5.25872L18.3821 4.16273L18.3673 5.32495L16.6961 6.81915C16.5731 6.92909 16.5709 7.10956 16.691 7.22223C16.7511 7.27859 16.8304 7.3073 16.91 7.30819C16.9897 7.30909 17.0697 7.28216 17.1312 7.22717L18.357 6.13115L18.345 7.08041L18.3343 7.92187C18.3283 8.3902 18.7703 8.77621 19.3194 8.78238L21.7061 8.80917C22.2553 8.81534 22.7069 8.43936 22.7129 7.97103L22.7236 7.12953L22.7357 6.18027L23.9333 7.3035C23.9933 7.35986 24.0726 7.38857 24.1523 7.38946C24.2319 7.39036 24.312 7.36343 24.3734 7.30845C24.4965 7.19851 24.4988 7.01808 24.3786 6.90537L22.7459 5.37408ZM22.1219 5.48527L22.1047 6.83754L18.9711 6.80236L18.9883 5.45009C18.9883 5.45001 18.9883 5.44997 18.9883 5.4499L19.0133 3.48182C19.0133 3.48171 19.0133 3.48156 19.0133 3.48144L19.0134 3.47685L22.147 3.51203L22.147 3.51662C22.147 3.51674 22.147 3.51689 22.147 3.517L22.1219 5.48508C22.1219 5.48512 22.1219 5.48519 22.1219 5.48527ZM19.4114 1.55328L21.7981 1.58008C22.0005 1.58235 22.1699 1.71218 22.168 1.86358L22.1543 2.94201L19.0206 2.90683L19.0344 1.8284C19.0363 1.677 19.2089 1.55101 19.4114 1.55328ZM21.7133 8.23908L19.3267 8.21228C19.1242 8.21001 18.9548 8.08018 18.9568 7.92878L18.9638 7.37237L22.0975 7.40755L22.0904 7.964C22.0885 8.1154 21.9158 8.24135 21.7133 8.23908Z"
						fill="#43ef01"
					/>
					<defs>
						<clipPath id="clip0_32_133">
							<rect width="9.63073" height="9.04761" fill="white" transform="translate(30.7729 0.952515)" />
						</clipPath>
						<clipPath id="clip1_32_133">
							<rect width="9.63073" height="9.04761" fill="white" transform="translate(0.866943)" />
						</clipPath>
					</defs>
				</svg>

				<svg width="50" height="40" viewBox="0 0 31 12" xmlns="http://www.w3.org/2000/svg">
					<path
						d="M7.20179 10H5.29379L2.29379 6.064V10H0.637788V1.6H2.29379V5.308L5.17379 1.6H7.08179L3.97379 5.68L7.20179 10ZM16.2406 1.6V10H14.5966V4.552L12.2326 8.452H12.0406L9.6766 4.564V10H8.0206V1.6H9.7246L12.1366 5.572L14.5366 1.6H16.2406ZM18.1058 11.2H17.4218L22.2218 0.4H22.9058L18.1058 11.2ZM28.863 1.6H30.507V10H28.863V6.52H25.743V10H24.087V1.6H25.743V4.936H28.863V1.6Z"
						fill="white"
						fill-opacity="0.5"
					/>
				</svg>
			</div>
		</div>
	);
};

export default Speedometer;
